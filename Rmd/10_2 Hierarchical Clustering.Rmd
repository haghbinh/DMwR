---
title: "Hierarchical Clustering"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Agglomerative Clustering
The agglomerative clustering is the most common type of hierarchical clustering used to group objects in clusters based on their similarity. 
```{r message=FALSE, warning=FALSE}
# Load the data
data("USArrests")

# Standardize the data
df <- scale(USArrests)

# Show the first 6 rows
head(df, nrow = 6)
```

There are many methods to calculate the (dis)similarity information, including Euclidean and manhattan distances. 

```{r message=FALSE, warning=FALSE}
# Compute the dissimilarity matrix
# df = the standardized data
res.dist <- dist(df, method = "euclidean")
```

Function **hclust()** can be used to create the hierarchical tree.
```{r message=FALSE, warning=FALSE}
res.hc <- hclust(d = res.dist, method = "ward.D2")
```
**d**: a dissimilarity structure as produced by the dist() function.<br>
**method:** The agglomeration (linkage) method to be used for computing distance between clusters. Allowed values is one of “ward.D”, “ward.D2”, “single”, “complete”, “average”, “mcquitty”, “median” or “centroid”.

### Dendrogram
Dendrograms correspond to the graphical representation of the hierarchical tree generated by the function hclust(). Dendrogram can be produced in R using the base function plot(res.hc), where res.hc is the output of hclust().
```{r message=FALSE, warning=FALSE}
plot(res.hc)
plot(res.hc,hang = 1)
# cex: label size
library("factoextra")
fviz_dend(res.hc, cex = 0.5)
```

## Cut the dendrogram into different groups
```{r message=FALSE, warning=FALSE}
# cut tree into 4 clusters
groups <- cutree(res.hc, k=4) 
groups[1:5]
table(groups)
plot(res.hc)
# draw dendogram with red borders around the 4 clusters 
plot(res.hc)
rect.hclust(res.hc, k=4, border="red")
fviz_dend(res.hc, cex = 0.5,
          k = 4, # Cut in four groups
          palette = "jco" # Color palette
          )
```

## Divisive Hierarchical Clustering
```{r message=FALSE, warning=FALSE}
# Compute diana()
library(cluster)
res.diana <- diana(df, stand = TRUE)

# Plot the dendrogram
library(factoextra)
fviz_dend(res.diana, cex = 0.5,
          k = 4, # Cut in four groups
          palette = "jco" # Color palette
          )
```